name: update-deps
on: [create, workflow_dispatch]
jobs:
  npm-update:
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version-file: '.nvmrc'
      - run: npm update --include=dev
      - run: git rm -r --cached .github
      - run: rm -rf .github/
      - uses: EndBug/add-and-commit@latest
        with:
          add: '.'
          message: 'Update dependencies with "npm update"'
          push: true
